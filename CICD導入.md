# CI/CDæ§‹æˆæ‰‹é †

## æœ€çµ‚ã‚´ãƒ¼ãƒ«

ğŸ¯ æœ€çµ‚ç›®çš„ã¾ã¨ã‚

| é …ç›®                     | å†…å®¹                             |
| ---------------------- | ------------------------------ |
| ãƒ‡ãƒ—ãƒ­ã‚¤ã®ãƒˆãƒªã‚¬ãƒ¼              | Git ã‚¿ã‚°ï¼ˆä¾‹: `v1.0.0`ï¼‰ã‚’ push ã—ãŸã¨ã |
| ãƒ‡ãƒ—ãƒ­ã‚¤å…ˆ                  | AWS EC2                        |
| develop ãƒ–ãƒ©ãƒ³ãƒã®åˆ¶ç´„        | ãƒ“ãƒ«ãƒ‰ãŒæˆåŠŸã™ã‚‹ã“ã¨                     |
| main ãƒ–ãƒ©ãƒ³ãƒã®åˆ¶ç´„           | ãƒ†ã‚¹ãƒˆãŒã™ã¹ã¦æˆåŠŸã™ã‚‹ã“ã¨                  |
| main / develop ç›´æ¥ push | âŒ ç¦æ­¢ï¼ˆPRçµŒç”±ã®ã¿è¨±å¯ï¼‰                 |


## ãƒ–ãƒ©ãƒ³ãƒä¿è­·

âœ… 1. ãƒ–ãƒ©ãƒ³ãƒä¿è­·ãƒ«ãƒ¼ãƒ«ï¼ˆGitHub å´è¨­å®šï¼‰
GitHub ã®ãƒ–ãƒ©ãƒ³ãƒä¿è­·æ©Ÿèƒ½ã‚’ä½¿ã£ã¦ä»¥ä¸‹ã‚’è¨­å®šï¼š

develop ãƒ–ãƒ©ãƒ³ãƒ
âœ… ãƒ—ãƒ«ãƒªã‚¯ã‚¨ã‚¹ãƒˆã®ã¿ãƒãƒ¼ã‚¸å¯

âœ… ãƒ“ãƒ«ãƒ‰ï¼ˆlint / å‹ãƒã‚§ãƒƒã‚¯ï¼‰ã«æˆåŠŸã—ã¦ã„ã‚‹ã“ã¨

âŒ ãƒ†ã‚¹ãƒˆçµæœã¯æ¤œè¨¼ã—ãªãã¦ã‚ˆã„

main ãƒ–ãƒ©ãƒ³ãƒ
âœ… ãƒ—ãƒ«ãƒªã‚¯ã‚¨ã‚¹ãƒˆã®ã¿ãƒãƒ¼ã‚¸å¯

âœ… ãƒ“ãƒ«ãƒ‰ + ãƒ†ã‚¹ãƒˆã«æˆåŠŸã—ã¦ã„ã‚‹ã“ã¨

ğŸ‘‰ è¨­å®šå ´æ‰€: GitHub ãƒªãƒã‚¸ãƒˆãƒªã® Settings > Branches > Branch protection rules

## GitHub Actions ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼æ§‹æˆ

âœ… 2. GitHub Actions ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼æ§‹æˆ

```bash
.github/workflows/
â”œâ”€â”€ validate-develop.yml   # develop å‘ã‘ã®ãƒ“ãƒ«ãƒ‰æ¤œè¨¼
â”œâ”€â”€ validate-main.yml      # main å‘ã‘ã®ãƒ†ã‚¹ãƒˆæ¤œè¨¼
â””â”€â”€ deploy-tag.yml         # Git ã‚¿ã‚°ä½œæˆæ™‚ã« EC2 ã¸ãƒ‡ãƒ—ãƒ­ã‚¤
```

âœ… 3. GitHub Secrets ã«ç™»éŒ²ã™ã‚‹

| ã‚­ãƒ¼å        | å†…å®¹                                                  |
| ---------- | --------------------------------------------------- |
| `EC2_KEY`  | `.pem` ã®ä¸­èº«ï¼ˆæ”¹è¡Œè¾¼ã¿ï¼‰                                    |
| `EC2_HOST` | EC2 ã®ãƒ‘ãƒ–ãƒªãƒƒã‚¯IP ã¾ãŸã¯ãƒ›ã‚¹ãƒˆåï¼ˆä¾‹: `xx.compute.amazonaws.com`ï¼‰ |


âœ… 4. ç§˜å¯†éµã‚’ GitHub Secrets ã«ç™»éŒ²ã™ã‚‹


* .pem ãƒ•ã‚¡ã‚¤ãƒ«ã®ä¸­èº«ã‚’ Base64 ã§ã¯ ã‚¨ãƒ³ã‚³ãƒ¼ãƒ‰ã›ãšãã®ã¾ã¾ã‚³ãƒ”ãƒ¼
* GitHub ã®ãƒªãƒã‚¸ãƒˆãƒª â†’ Settings â†’ Secrets and variables â†’ Actions â†’ New repository secret
* Name: EC2_KEY, Value: -----BEGIN RSA PRIVATE KEY----- ã€œ ã¨ã—ã¦ä¿å­˜

